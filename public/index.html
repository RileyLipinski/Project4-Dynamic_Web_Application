<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
	<title>Crime Statistics in St. Paul</title>
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
   integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
   crossorigin=""/>
   <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
   <script type="application/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
   <script type="application/javascript" src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
	<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
	integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
	crossorigin=""></script>
	<script src="/js/leafletstuff.js"></script>
    <script type="application/javascript">
        var crime_data;
        var crime_in_view;
        function Prompt() {
            $("#dialog-form").dialog({
                autoOpen: true,
                modal: true,
                width: "360px",
                buttons: {
                    "Ok": function() {
                        var prompt_input = $("#prompt_input");
                        Init(prompt_input.val());
                        $(this).dialog("close");
                    },
                    "Cancel": function() {
                        $(this).dialog("close");
                    }
                }
            });
        }

        function Init(crime_api_url) {
            console.log(crime_api_url);
            neighborhoods(crime_api_url);
            $.getJSON(crime_api_url + "/incidents?start_date=2019-10-01&end_date=2019-10-31", (data) =>
            {
                console.log(data);
                crime_data = data;
                mapInit();
                updatePan();
            });
        }
    </script>
	<style>
		#mymap{ height: 400px; }
	</style>
</head>
<body onload="Prompt()">
	<div id="mymap"></div>
	<div id="mapInput">
        Map Location:
        <input type="text" v-model="Location">
        <button type="button" v-on:click="sendLocation">Search</button>
    </div>
    <div id="mapTable">
        <table v-if="crimes != {}">
        <tr>
            <th>Date</th>
            <th>Time</th>
            <th>Incident</th>
            <th>Police Grid</th>
            <th>Neighborhood</th>
            <th>Block</th>
        </tr>
            <tr v-for="item in crimes">
                    <td>{{ item.date }}</td>
                    <td>{{ item.time }}</td>
                    <td>{{ item.incident }}</td>
                    <td>{{ item.police_grid }}</td>
                    <td>{{ item.neighborhood }}</td>
                    <td>{{ item.block }}</td>
                </tr>
        </table>
    </div>
    
	<div id="dialog-form">
			<label for="name">URL for St. Paul Crime API:</label>
			<input type="text" id="prompt_input" class="text ui-widget-content ui-corner-all" style="width: 320px;"/>
	</div>
	<script src="/js/vuestuff.js"></script>
	
</body>
</html>
